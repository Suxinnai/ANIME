---
import { Smartphone, Battery, Wifi, MapPin, Zap } from "lucide-react";
---

<!-- 
  Digital Twin Widget 
  Style: User Reference (Floating Glass/White Card)
  Positioning: This component is designed to be absolutely positioned relative to a parent container.
-->
<div
    id="digital-twin"
    class="w-[220px] bg-white/90 backdrop-blur-xl border border-white/50 rounded-2xl shadow-[0_8px_30px_rgb(0,0,0,0.08)] p-4 relative overflow-hidden group select-none cursor-default hover:scale-105 transition-transform duration-300 ease-out"
>
    <!-- Decoration: Lively Gradient Blob background opacity -->
    <div
        class="absolute -top-10 -right-10 w-24 h-24 bg-blue-100/50 rounded-full blur-2xl pointer-events-none"
    >
    </div>

    <!-- Top Section: Current App Context -->
    <div class="flex items-start justify-between mb-4">
        <div>
            <h3
                class="text-lg font-bold text-gray-800 leading-tight"
                id="dt-app-name"
            >
                VS Code
            </h3>
            <p class="text-[10px] text-gray-400 font-medium mt-0.5">
                正在编写代码...
            </p>
        </div>
        <!-- Status Dot -->
        <div class="relative flex items-center justify-center w-3 h-3 mt-1.5">
            <span
                class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"
            ></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"
            ></span>
        </div>
    </div>

    <!-- Divider -->
    <!-- <div class="h-px w-full bg-gray-100 my-3"></div> -->

    <!-- Stats List -->
    <div class="space-y-2.5">
        <!-- Battery -->
        <div class="flex items-center gap-2.5 text-xs text-gray-600">
            <div
                class="w-5 h-5 rounded-full bg-gray-50 flex items-center justify-center text-gray-400"
            >
                <Zap className="w-3 h-3" />
            </div>
            <div class="flex flex-col">
                <span class="text-[10px] text-gray-400 leading-none mb-0.5"
                    >Energy</span
                >
                <span class="font-bold flex items-center gap-1">
                    <span id="dt-battery-text">85%</span>
                    <!-- Visual Battery Bar -->
                    <div
                        class="w-8 h-1.5 bg-gray-200 rounded-full overflow-hidden ml-1"
                    >
                        <div
                            id="dt-battery-bar"
                            class="h-full bg-green-400 rounded-full"
                            style="width: 85%"
                        >
                        </div>
                    </div>
                </span>
            </div>
        </div>

        <!-- Network -->
        <div class="flex items-center gap-2.5 text-xs text-gray-600">
            <div
                class="w-5 h-5 rounded-full bg-gray-50 flex items-center justify-center text-gray-400"
            >
                <Wifi className="w-3 h-3" />
            </div>
            <div class="flex flex-col">
                <span class="text-[10px] text-gray-400 leading-none mb-0.5"
                    >Network</span
                >
                <span class="font-bold" id="dt-network">WiFi • 5G</span>
            </div>
        </div>

        <!-- Location -->
        <div class="flex items-center gap-2.5 text-xs text-gray-600">
            <div
                class="w-5 h-5 rounded-full bg-gray-50 flex items-center justify-center text-gray-400"
            >
                <MapPin className="w-3 h-3" />
            </div>
            <div class="flex flex-col">
                <span class="text-[10px] text-gray-400 leading-none mb-0.5"
                    >Location</span
                >
                <span class="font-bold">Neo-Tokyo, Sector 7</span>
            </div>
        </div>

        <!-- Device -->
        <div class="flex items-center gap-2.5 text-xs text-gray-600">
            <div
                class="w-5 h-5 rounded-full bg-gray-50 flex items-center justify-center text-gray-400"
            >
                <Smartphone className="w-3 h-3" />
            </div>
            <div class="flex flex-col">
                <span class="text-[10px] text-gray-400 leading-none mb-0.5"
                    >Device</span
                >
                <span class="font-bold">Neural Link v2.0</span>
            </div>
        </div>
    </div>
</div>

<script>
    // Live Data Simulation
    function updateDigitalTwin() {
        const apps = [
            { name: "VS Code", subtitle: "正在重构现实..." },
            { name: "Spotify", subtitle: "播放: Cyberpunk OST" },
            { name: "Figma", subtitle: "设计未来界面..." },
            { name: "Terminal", subtitle: "sudo rm -rf /bugs" },
            { name: "Chrome", subtitle: "浏览 Stack Overflow..." },
        ];

        const randomApp = apps[Math.floor(Math.random() * apps.length)];
        const randomBattery = Math.floor(Math.random() * (100 - 40) + 40);

        const appNameEl = document.getElementById("dt-app-name");
        const appSubEl = appNameEl?.nextElementSibling;
        const batTextEl = document.getElementById("dt-battery-text");
        const batBarEl = document.getElementById("dt-battery-bar");

        if (appNameEl) appNameEl.innerText = randomApp.name;
        if (appSubEl) appSubEl.innerText = randomApp.subtitle;
        if (batTextEl) batTextEl.innerText = `${randomBattery}%`;
        if (batBarEl) {
            batBarEl.style.width = `${randomBattery}%`;
            // Color Logic
            if (randomBattery > 60)
                batBarEl.className =
                    "h-full bg-green-400 rounded-full transition-all duration-500";
            else if (randomBattery > 20)
                batBarEl.className =
                    "h-full bg-yellow-400 rounded-full transition-all duration-500";
            else
                batBarEl.className =
                    "h-full bg-red-400 rounded-full transition-all duration-500";
        }
    }

    // Update every 3 seconds
    setInterval(updateDigitalTwin, 3000);
</script>
